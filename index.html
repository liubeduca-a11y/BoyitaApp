<div class="app-container">
    <nav class="tab-bar">
        <button onclick="cambiarPesta√±a('registro')" id="tab-registro" class="active-tab">üìù Registro</button>
        <button onclick="cambiarPesta√±a('dashboards')" id="tab-dashboards">üìä Resumen</button>
    </nav>

    <div id="pesta√±a-registro">
        <header>
            <h1>üçº Boyita Tracker</h1>
            <p id="fecha-actual"></p>
        </header>

        <h3>Historial Hoy</h3>
        <div id="listaRegistros"></div>
    </div>

    <div id="pesta√±a-dashboards" style="display: none;">
        <header>
            <h1>üìä Resumen de Boyita</h1>
        </header>

        <div class="card" style="text-align: center;">
            <h3>Consumo de Hoy</h3>
            <div class="bottle">
                <div id="bottle-filler" class="water"></div>
            </div>
            <p id="total-onzas-texto" style="font-size: 28px; font-weight: bold; color: #6366f1;">0 oz</p>
            <p style="font-size: 12px; color: #666;">Meta diaria: 30 oz</p>
        </div>
        
        </div>

    <button onclick="descargarCSV()" class="btn-main" style="background-color: #10b981; margin-top: 20px;">üì• Descargar CSV</button>
    <button onclick="resetearApp()" class="btn-reset">Borrar todo</button>
</div>
function toggleSueno() {
    const btn = document.getElementById('btn-sueno');
    const detalleDiv = document.getElementById('detalle-despertar');
    const inputNota = document.getElementById('notaSueno');
    const selectEstado = document.getElementById('estadoDespertar');

    if (!durmiendo) {
        // --- EMPIEZA A DORMIR ---
        localStorage.setItem('horaInicio', new Date().toISOString());
        durmiendo = true;
        
        // Cambios visuales inmediatos
        btn.innerText = "¬°Despert√≥! ‚òÄÔ∏è";
        btn.style.backgroundColor = "#f59e0b";
        detalleDiv.style.display = "block";
    } else {
        // --- DESPIERTA (AQU√ç CAPTURAMOS TODO) ---
        const horaInicioStr = localStorage.getItem('horaInicio');
        if (horaInicioStr) {
            const inicio = new Date(horaInicioStr);
            const fin = new Date();
            const duracion = Math.round((fin - inicio) / 1000 / 60);
            
            // CAPTURA CR√çTICA: Leemos los valores ANTES de cualquier otra cosa
            const estado = selectEstado.value;
            const nota = inputNota.value.trim();
            
            let det = `Durmi√≥ ${duracion} min (${estado})`;
            if (nota !== "") {
                det += ` - Nota: ${nota}`;
            }

            // GUARDAMOS
            guardarDato({ tipo: "Sue√±o", detalle: det });
        }

        // RESET DE ESTADO
        localStorage.removeItem('horaInicio');
        durmiendo = false;
        
        // LIMPIEZA VISUAL
        btn.innerText = "Empez√≥ a dormir üåô";
        btn.style.backgroundColor = "#4a5568";
        detalleDiv.style.display = "none";
        inputNota.value = ""; // Limpiamos el texto
    }
}
        <h3>Historial</h3>
        <div id="listaRegistros"></div>
        
        <button onclick="descargarCSV()" class="btn-main" style="background-color: #10b981; margin-top: 20px;">üì• Descargar CSV</button>
        <button onclick="resetearApp()" class="btn-reset">Borrar todo y empezar de cero</button>
    </div>
    <script src="script.js"></script>
</body>
</html>
